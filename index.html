<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로그인 처리 중...</title>
</head>
<body>
    <h3>앱으로 돌아가는 중입니다...</h3>
    <script>
        // 1. 현재 URL의 파라미터 가져오기
        var query = window.location.search; // ?code=abc... (쿼리 스트링)
        var hash = window.location.hash;    // #access_token=xyz... (해시)

        // 2. Unity로 보낼 기본 스킴 헤더
        var schemePrefix = "ginovo-unity://";
        var targetPath = "";

        // 3. [핵심 로직] 파라미터로 누구인지 판별
        // Line은 Authorization Code 방식이라 'code=' 가 쿼리 스트링에 포함됨
        if (query.includes("code=")) {
            targetPath = "line_callback";
        }
        // Naver는 Implicit 방식이라 'access_token=' 이 해시(#)에 포함됨
        // (또는 에러 상황일 때도 기본적으로 Naver로 처리하거나 추가 분기 가능)
        else {
            targetPath = "naver_callback";
        }

        // 4. 최종 URL 조합 (기존 파라미터 유실 없이 몽땅 붙여서 보냄)
        // 예: ginovo-unity://line_callback?code=...&state=...
        var finalUrl = schemePrefix + targetPath + query + hash;

        // 디버깅용 메시지 (PC 브라우저에서 확인용)
        document.getElementById("debug-msg").innerText = "Redirecting to: " + targetPath;

        // 5. Unity 앱으로 리다이렉트
        setTimeout(function() {
            window.location.href = finalUrl;
        }, 100); // 0.1초 뒤 실행 (브라우저 처리 안정성 확보)
    </script>
</body>
</html>
